<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mercury Games</title>
<style>
html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    background: #000;
}
iframe {
    width: 100%;
    height: 100%;
    border: none;
    display: block;
}
.error-message {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-family: Arial, sans-serif;
    text-align: center;
    flex-direction: column;
    gap: 20px;
    padding: 20px;
    box-sizing: border-box;
}
.error-message h2 {
    margin: 0;
    font-size: 24px;
}
.error-message p {
    margin: 0;
    font-size: 14px;
    color: #aaa;
}
#game-container {
    width: 100%;
    height: 100%;
}
.retry-btn {
    padding: 10px 20px;
    background: #4CAF50;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
}
.retry-btn:hover {
    background: #45a049;
}
</style>
</head>
<body>
<div id="game-container">
    <div class="error-message" id="loading">
        <h2>Loading game...</h2>
        <p>Please wait...</p>
    </div>
</div>

<script>
// Get game number from query param or default
const params = new URLSearchParams(window.location.search);
const gameNum = params.get('game') || '42';
const gameUrl = `https://mercurygames-15327267.codehs.me/game${gameNum}.html`;

function loadGame() {
    const container = document.getElementById('game-container');
    container.innerHTML = '';
    
    const iframe = document.createElement('iframe');
    iframe.src = gameUrl;
    iframe.style.width = '100%';
    iframe.style.height = '100%';
    iframe.style.border = 'none';
    iframe.style.display = 'block';
    iframe.setAttribute('allowfullscreen', 'true');
    iframe.setAttribute('allow', 'fullscreen; accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture');
    
    let loadTimeout;
    let loaded = false;
    
    const onLoad = () => {
        loaded = true;
        clearTimeout(loadTimeout);
        console.log('Game loaded successfully');
    };
    
    const onError = () => {
        clearTimeout(loadTimeout);
        if (!loaded) {
            console.log('Game load error or timeout');
            showError();
        }
    };
    
    loadTimeout = setTimeout(() => {
        if (!loaded) {
            console.log('Game load timeout - assuming it loaded anyway');
            // Don't show error on timeout, assume it's loading in background
        }
    }, 10000);
    
    iframe.addEventListener('load', onLoad);
    iframe.addEventListener('error', onError);
    
    try {
        container.appendChild(iframe);
    } catch (e) {
        console.error('Error appending iframe:', e);
        showError();
    }
}

function showError() {
    const container = document.getElementById('game-container');
    container.innerHTML = `
        <div class="error-message">
            <h2>⚠️ Unable to Load Game</h2>
            <p>The game server is not responding.</p>
            <p style="font-size: 12px; margin-top: 10px;">The external game server may be temporarily unavailable.</p>
            <button class="retry-btn" onclick="location.reload()">Retry</button>
        </div>
    `;
}

// Start loading
if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', loadGame);
} else {
    loadGame();
}
</script>
</body>
</html>
